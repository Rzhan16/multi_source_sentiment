<!doctype html><html><head>
    <meta charset="utf-8"><title>Stock Sentiment</title>
    <link rel="stylesheet" href="/static/css/style.css">
  </head><body>
  <h1>Reddit Stock Sentiment Analyzer</h1>
  
  <form id="f">
    <input id="sym" placeholder="AAPL" required>
    <button>Analyze</button>
  </form>
  
  <div id="out"></div>
  
  <script>
  document.getElementById('f').addEventListener('submit', async e=>{
    e.preventDefault();
    const sym=document.getElementById('sym').value.toUpperCase(),
          box=document.getElementById('out');
    box.innerHTML='<p class="loading">Loadingâ€¦</p>';
    const res=await fetch('/analyze',{method:'POST',
          headers:{'Content-Type':'application/x-www-form-urlencoded'},
          body:`stock_symbol=${sym}`});
    const data=await res.json();
    if(data.error||!data.sentiment.success){
        box.innerHTML=`<p class="error">${data.error||data.sentiment.error}</p>`;return;}
    box.innerHTML=`
     <h2>${sym}</h2>
     <p>Average sentiment ${(data.sentiment.average_sentiment*100).toFixed(1)}%</p>
     <p>${data.stock_data.data.currency}${data.stock_data.data.current_price}</p>
     ${data.plot_url?`<img src="${data.plot_url}" width="600">`:''}`;
  });
  </script>
  </body></html>
  